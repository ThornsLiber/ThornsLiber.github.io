[{"title":"开发日志20240105","url":"/2024/01/06/%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%9720240105/","content":"**开发日志20240105🚀️ **\nlogin页面：检查登录状态：未登录：弹出框提示登录（账号密码登录）已登录：直接显示账号密码登录–登录后获取微信权限–下次无需登录\n\n 已完成🎉️解决方法：首次登录时，将用户的openid存入数据库，下一次回到该页面直接匹配用户openid和数据库中的openid是否一致，如果一致，直接显示用户信息，如果没有该用户openid则显示账号密码页面，由用户自行输入账号密码并储存其openid到数据库，用于下次验证。\n\nonLoad() &#123;    wx.showLoading(&#123;      title: &#x27;请稍候~&#x27;,      mask:true//设置遮罩层以免误触    &#125;)    setTimeout(function () &#123;      wx.hideLoading()    &#125;, 2000)//给出时间验证用户openid    let openid = wx.getStorageSync(&#x27;openid&#x27;)    console.log(openid)    db.collection(&quot;database&quot;).where(&#123;        openid      &#125;).get()      .then(res =&gt; &#123;        let len = res.data.length //长度判断        if (len == 0) &#123;          this.setData(&#123;            //账号密码登录界面          &#125;)        &#125; else &#123;          this.setData(&#123;            //用户信息          &#125;)        &#125;      &#125;)  &#125;,\n\n\n20240106任务：\n1.增加管理员权限：增加、修改、删除员工信息2.修改图标且仅管理员展示3.改完成后返回并刷新页面4.其他页面调整\n","categories":["开发日志"],"tags":["登录","学习"]},{"title":"tips","url":"/2024/01/06/tips/","content":"TIPS\n即日起（2024年1月6日星期六），该网站（原名“云小帮”）正式更名为“Henry小屋”，用于记录本人的小程序开发日志、bug合集以及心得等，logo如下：\n\n","categories":["杂记"],"tags":["学习","日常"]},{"title":"开发日志20240106","url":"/2024/01/07/%E5%BC%80%E5%8F%91%E6%97%A5%E5%BF%9720240106/","content":"开发日志20240106🚀️bug1：popup中嵌入Area导致有两个标题解决方案：1、调低popup高度2、删除popup的关闭点击事件保留area的关闭点击事件\nbug2：身份改变权限改变解决方案：js做判断，如果身份改变为较低一级，即权限减少，直接返回到首页并刷新页面。\nonShow()&#123;   this.onLoad(); //到达该页面时刷新页面&#125;,\n\n问题一：view的层级和点击事件一个大的view它本身含有一个点击事件，他的子view也含有一个点击事件。当点击  son 事件时，parent 事件也会被触发。\n&lt;view bindtap=&quot;parent&quot;&gt;      &lt;view bindtap=&quot;son&quot;&gt;&lt;/view&gt;&lt;/view&gt;\n\n解决方法：\n&lt;view bindtap=&quot;parent&quot;&gt;      &lt;view catchtap=&quot;son&quot; hover-stop-propagation=&quot;true&quot;&gt;&lt;/view&gt;&lt;/view&gt;\n\n原因：catchtap : 捕获事件，组织冒泡hover-stop-propagation ：指定是否阻止本节点的祖先节点出现点击态\n\n【参考】微信小程序多层view的点击穿透问题：https://www.jianshu.com/p/e1a624ca70bf\n\n\n问题二：wxml做判断不同status给不同的样式：\nstyle=&quot;&#123;&#123;item.status == 1 ? style2 : style1&#125;&#125;&quot;\n\n问题三：省市区数据全局化（对应修改为部门数据）如果不使用云开发，直接内置到小程序中，则用户无法根据自身情况编辑部门分类，但是其适用于组织结构较为死板的组织。出现引入不成功的情况解决方法：将 area-data&#x2F;dist 下面的 index.esm.mjs 文件改名为 name.js，而后修改引入路径即可。\n\nvant省市区引入@vant&#x2F;area-data官方数据报错问题解决https://blog.csdn.net/hy3528/article/details/131597399\n\n如果使用云开发则直接在数据库中输入对象数组，但是要给用户自由输入还存在一定困难，该问题放在以后处理。\n\n基于小程序云开发能力和vant业务组件实现省市区选择https://cloud.tencent.com/developer/article/1583130\n\n知识积累：1、获取当前时间：\nconst now = new Date();const year = now.getFullYear();const month = String(now.getMonth() + 1).padStart(2, &#x27;0&#x27;);const day = String(now.getDate()).padStart(2, &#x27;0&#x27;);const hours = String(now.getHours()).padStart(2, &#x27;0&#x27;);const minutes = String(now.getMinutes()).padStart(2, &#x27;0&#x27;);const seconds = String(now.getSeconds()).padStart(2, &#x27;0&#x27;);const formattedTime = year + month + day + hours + minutes + seconds; console.log(formattedTime); //输出为字符串\n\n2、数字转化为字符串\nnum.toString()\n\n3、固定位数前方补0\n“abc”.padStart(4, “0”)  //0abc\n\n4、字符串截取\ntest.substr(-4)  //向后截取4位\n\n任务1、登录验证：获取的openid和数据库中的openid进行比较，不一致不允许登录，需要一个设备退出登陆才可以登录该账号。2、组织划分：用户只可以看到自己所在组织的各组数据，即小程序面向组织与个人3、添加组织数据库，增加检索功能，用户可以检索到组织，并加入组织，需要得到审核，审核后才可以加入，增加安全性4、修改逻辑：用户申请加入组织时填写相关信息，包括姓名、性别、电话、密码等，由审核人员为其分配部门和身份\n","categories":["开发日志"],"tags":["学习","知识积累"]}]